---
import { Image } from "astro:assets";
import profile_image from "/public/assets/cv/profile_image.jpeg";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";

import Button from "../shared/ui/Button.astro";
import ImagePreviewer from "../shared/ui/ImagePreviewer.tsx";
import { FaArrowDown, FaWhatsapp } from "react-icons/fa";
import { LuDownload, LuEye, LuGithub, LuMail } from "react-icons/lu";
import { BsLinkedin } from "react-icons/bs";

import { contact } from "@/config/config.json";
import PresentationAnimations from "./animations/PresentationAnimations";
import AnimatedButtonWrapper from "../shared/animations/AnimatedButtonWrapper";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const linkedInUrl = lang === "en" ? contact.linkedInEN : contact.linkedInES;

// Imagenes del CV
const images = [
    `${contact.cvView}/${lang}/cv_1.jpg`,
    `${contact.cvView}/${lang}/cv_2.jpg`,
];
---

<section
    class="presentation-text-section relative flex flex-col justify-center items-center text-center overflow-hidden
  min-h-[calc(100vh-4rem)] w-screen left-[calc(-50vw+50%)] px-6 py-20"
>
    <!-- Fondo animado con ondas -->
    <div class="absolute inset-0 -z-10">
        <svg
            class="absolute inset-0 w-full h-full -z-10"
            viewBox="0 0 800 600"
            xmlns="http://www.w3.org/2000/svg"
            preserveAspectRatio="xMidYMid slice"
        >
            <defs>
                <linearGradient id="gradient" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0%" stop-color="#5eead4">
                        <animate
                            attributeName="stop-color"
                            values="#5eead4; #2dd4bf; #22d3ee; #5eead4"
                            dur="8s"
                            repeatCount="indefinite"></animate>
                    </stop>
                    <stop offset="100%" stop-color="#06b6d4">
                        <animate
                            attributeName="stop-color"
                            values="#06b6d4; #0ea5e9; #2dd4bf; #06b6d4"
                            dur="8s"
                            repeatCount="indefinite"></animate>
                    </stop>
                </linearGradient>
            </defs>

            <path fill="url(#gradient)" fill-opacity="0.4">
                <animate
                    attributeName="d"
                    dur="10s"
                    repeatCount="indefinite"
                    values="
          M0,300 Q150,200 400,300 T800,300 V600 H0 Z;
          M0,300 Q150,400 400,300 T800,300 V600 H0 Z;
          M0,300 Q150,200 400,300 T800,300 V600 H0 Z
          "
                ></animate>
            </path>
        </svg>
    </div>

    <!-- Contenido principal -->
    <div class="max-w-4xl mx-auto flex flex-col items-center space-y-8">
        <!-- Imagen de perfil -->
        <div class="relative presentation-image">
            <div
                class="w-36 h-36 sm:w-40 sm:h-40 md:w-48 md:h-48 overflow-hidden rounded-full border-4
        border-slate-300/60 dark:border-gray-700/60 shadow-lg"
            >
                <Image
                    src={profile_image}
                    alt="Profile"
                    width={500}
                    height={500}
                    loading="eager"
                    class="h-full w-full object-cover"
                />
            </div>
        </div>

        <!-- Texto principal -->
        <div class="space-y-4">
            <p
                class="font-saira text-sm uppercase tracking-[0.2em] text-slate-600 dark:text-gray-400 font-medium"
            >
                {t("presentation.profession")}
            </p>

            <h1
                class="font-saira text-4xl sm:text-5xl md:text-6xl font-bold leading-tight text-slate-900 dark:text-white"
            >
                {t("presentation.name")}
            </h1>

            <p
                class="font-saira max-w-2xl mx-auto text-base sm:text-lg text-slate-700 dark:text-gray-300 leading-relaxed"
            >
                {t("presentation.additional-text")}
            </p>
        </div>

        <!-- Botones de acción (contacto y CV) -->
        <div class="flex flex-wrap justify-center gap-4 pt-4">
            <Button
                target="_blank"
                label={t('presentation.downloadCv')}
                icon={LuDownload}
                href={`${contact.cvDownload}/${lang}/cv.pdf`}
                variant="solid"
            />
            <div class="w-[140px] h-[44px] flex items-center justify-center">
                <ImagePreviewer urlImages={images} client:only="react">
                        <AnimatedButtonWrapper client:only="react">
                            <Button label={t('presentation.viewCv')} icon={LuEye} variant="outline" />
                        </AnimatedButtonWrapper>
                </ImagePreviewer>
            </div>
            <Button
                target="_blank"
                label="GitHub"
                icon={LuGithub}
                href={`${contact.github}`}
                variant="ghost"
            />
            <Button label="Email" icon={LuMail} href={`${contact.email}`} />
            <Button
                target="_blank"
                label="Whatsapp"
                icon={FaWhatsapp}
                href={`${contact.whatsapp}`}
            />
            <Button
                target="_blank"
                label="LinkedIn"
                icon={BsLinkedin}
                href={`${linkedInUrl}`}
            />
        </div>

        <!-- Flecha hacia siguiente sección -->
        <div class="pt-8">
            <Button
                icon={FaArrowDown}
                dataScroll="#technologies"
                variant="outline"
            />
        </div>
    </div>
</section>

<PresentationAnimations client:only="react" />
